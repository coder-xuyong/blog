---
title: minio 上传、下载和删除案例
date: 2025-04-09
# cover: https://mc.kurogames.com/static4.0/assets/sanhua-57e3ff0d.png
lastUpdated: true
isOrigin: true
author: 
    - name: xuyong
      url: https://github.com/coder-xuyong
    - name: 悟空
      url: https://www.yuque.com/wukong-zorrm
category:
  - minio

tag:
  - io

order: 2
star: true
permalinkPattern: :year/:month/:day/:slug.html
---

## 引入maven依赖

```xml
<dependency>
    <groupId>io.minio</groupId>
    <artifactId>minio</artifactId>
    <version>8.4.3</version>
</dependency>
```

## 文件的上传、下载、删除操作

```java
import io.minio.*;
import io.minio.errors.ErrorResponseException;

import java.io.FileInputStream;
import java.io.InputStream;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.nio.file.StandardCopyOption;

public class Main {

    public static void main(String[] args) {

        String fileName = "1715759535550.jpg";
        Path path = Paths.get("E:\\BaiduNetdiskDownload\\minio\\" + fileName);
        String bucketName = "test";
        try (FileInputStream fileInputStream = new FileInputStream(path.toString())) {
            //1.创建minio链接客户端 accessKey: minio账号 secretKey: minio密码  endpoint: 文件上传地址
            MinioClient minioClient = MinioClient.builder().credentials("minioadmin", "minioadmin").endpoint("http://10.100.50.67:9000/").build();
            //2.上传
            PutObjectArgs putObjectArgs = PutObjectArgs.builder()
                    //文件名
                    .object(fileName)
                    //文件类型
                    .contentType("application/vnd.openxmlformats-officedocument.presentationml.presentation")
                    //桶名词  与minio创建的名词一致
                    .bucket(bucketName)
                    //文件流
                    .stream(fileInputStream, fileInputStream.available(), -1)
                    .build();
            minioClient.putObject(putObjectArgs);

            System.out.println("文件上传成功");


//            ======================================================================================
            GetObjectArgs build = GetObjectArgs.builder()
                    .object(fileName)
                    .bucket(bucketName)
                    .build();
            InputStream object = minioClient.getObject(build);

            // 定义本地保存路径
            String localFilePath = "E:\\BaiduNetdiskDownload\\minio\\download\\" + fileName;

            // 使用NIO进行高效文件写入
            Files.copy(object, Paths.get(localFilePath), StandardCopyOption.REPLACE_EXISTING);
            System.out.println("文件下载成功，保存路径：" + localFilePath);

//            ==============================================================================================

            if (!objectExists(minioClient, bucketName, fileName)) {
                System.out.println("文件不存在，无需删除");
                return;
            }
            RemoveObjectArgs removeArgs = RemoveObjectArgs.builder()
                    .bucket(bucketName)
                    .object(fileName)
                    .build();
            minioClient.removeObject(removeArgs);

            if (objectExists(minioClient, bucketName, fileName)) {
                throw new RuntimeException("文件删除失败，仍可检测到对象");
            }
            System.out.println("文件删除成功");
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    // 验证对象是否存在
    private static boolean objectExists(MinioClient client, String bucket, String object) {
        try {
            client.statObject(StatObjectArgs.builder()
                    .bucket(bucket)
                    .object(object)
                    .build());
            return true;
        } catch (ErrorResponseException e) {
            if ("NoSuchKey".equals(e.errorResponse().code())) {
                return false;
            }
            throw new RuntimeException("对象状态检查失败", e);
        } catch (Exception e) {
            throw new RuntimeException("对象状态检查异常", e);
        }
    }
}
```